
【フォルダ構成】
pdf_extractor/
│
├── data/
│   ├── input/          # 入力PDFファイル
│   ├── output/         # 出力結果（JSON, CSV等）
│   └── temp/           # 一時ファイル（画像変換等）
│
├── src/
│   ├── __init__.py
│   ├── config.py       # 設定ファイル（API キー等）
│   ├── extractor.py    # 基本的なテキスト抽出モジュール
│   ├── ocr.py          # OCR処理モジュール
│   ├── preprocessor.py # 画像前処理モジュール
│   ├── parser.py       # 構造化データ変換モジュール
│   ├── ai_enhancer.py  # AI API連携モジュール
│   └── utils.py        # ユーティリティ関数
│
├── notebooks/
│   ├── 01_basic_extraction.ipynb     # 基本抽出テスト
│   ├── 02_ocr_testing.ipynb          # OCRテスト
│   ├── 03_data_parsing.ipynb         # データ構造化テスト
│   ├── 04_ai_enhancement.ipynb       # AI API活用テスト
│   └── 05_complete_pipeline.ipynb    # 完全なパイプライン
│
├── tests/
│   ├── __init__.py
│   ├── test_extractor.py
│   ├── test_ocr.py
│   └── test_parser.py
│
├── requirements.txt
├── setup.py
└── README.md
【開発方針】
# 活動計算書PDF抽出システム開発方針

## 段階的開発アプローチ

### フェーズ1: 基本機能の迅速なテスト (1-3日)
1. **PDF読取テスト**
   - 基本的なPDF抽出機能の実装と検証
   - 数種類のPDFでテストし、課題を特定
   - ノートブック `01_basic_extraction.ipynb` で検証

2. **OCR機能の簡易テスト**
   - PDF→画像変換と基本OCRのテスト
   - 異なる品質のPDFでOCR精度を評価
   - ノートブック `02_ocr_testing.ipynb` で検証

3. **AI API簡易テスト**
   - ClaudeやGPTに抽出テキストを送信するテスト
   - プロンプトの簡易評価
   - ノートブック `04_ai_enhancement.ipynb` で検証

### フェーズ2: コア機能の実装 (4-7日)
1. **基本モジュールの実装**
   - `extractor.py` - テキスト抽出機能
   - `ocr.py` - 基本OCR機能
   - `preprocessor.py` - 簡易前処理
   - `parser.py` - 基本的なデータ構造化

2. **シンプルなパイプラインの構築**
   - テキスト抽出→OCR→構造化の基本フロー
   - 品質評価の簡易実装
   - `utils.py` にパイプライン関数を実装

3. **財務諸表項目認識の基礎実装**
   - 基本的な項目リストの作成
   - 単純なパターンマッチング実装

### フェーズ3: 改良と拡張 (8-14日)
1. **モジュールの改良**
   - OCR精度向上（画像前処理最適化）
   - パターン認識の高度化
   - エラーハンドリングの強化

2. **AI 連携の強化**
   - 効果的なプロンプト設計
   - 抽出結果の整合性チェック
   - AI APIの適応的使用

3. **データ構造化の高度化**
   - 階層関係の推定
   - 数値の正規化と検証
   - 複数形式へのエクスポート

### フェーズ4: 完成と最適化 (15-18日)
1. **全体の最適化**
   - パフォーマンス向上
   - エッジケース対応
   - コード整理とドキュメント化

2. **完全なパイプラインのテスト**
   - 様々なPDFでの総合テスト
   - ノートブック `05_complete_pipeline.ipynb` で検証

## 実装優先度と具体的手順

### 最初の1週間（クイックスタート）
1. **Day 1-2: 基盤整備とテスト環境**
   - リポジトリセットアップ
   - 基本ライブラリインストール
   - テスト用PDFの収集
   - `01_basic_extraction.ipynb` で基本抽出テスト実施

2. **Day 3-4: 基本機能実装**
   - `extractor.py` - PyPDF2による基本抽出機能
   - `ocr.py` - Tesseractによる基本OCR機能
   - `02_ocr_testing.ipynb` でOCRテスト

3. **Day 5-7: 構造化とAI連携テスト**
   - `parser.py` - 基本的なデータ構造化
   - `ai_enhancer.py` - 簡易API連携
   - `03_data_parsing.ipynb` と `04_ai_enhancement.ipynb` でテスト

### 中期段階（機能強化）
1. **Week 2: コア機能の強化**
   - 画像前処理の最適化
   - パターン認識の改良
   - 財務諸表項目の辞書拡張

2. **Week 3前半: 統合と検証**
   - 完全なパイプラインの構築
   - 多様なPDFでの検証
   - エラーケース対応

### テスト戦略
1. **各モジュールの独立テスト**
   - 特定機能に焦点を当てたノートブック
   - 異なる入力でのエッジケーステスト

2. **段階的な統合テスト**
   - モジュールを組み合わせたテスト
   - エラー時のフォールバック検証

3. **最終的な総合テスト**
   - 完全なパイプラインでのエンドツーエンドテスト
   - パフォーマンス測定

## 具体的な実装ヒント

### 効果的な開発のためのポイント
1. **config.pyの早期設定**
   - パスや閾値などを集約
   - API KEYは環境変数で管理

2. **データ流れの標準化**
   - モジュール間のデータ形式を統一
   - エラー情報の伝播方法を標準化

3. **段階的な処理の判断基準**
   - 基本抽出からOCR、AIへの移行基準を明確に
   - 品質評価の指標を定義

### AI APIの効果的な活用
1. **低精度時のみAI活用**
   - 基本抽出とOCRで十分な場合はAIを使わない
   - 品質スコアに基づいた判断

2. **効果的なプロンプト設計**
   - 抽出結果の文脈を提供
   - 期待する出力形式を明示

## 迅速な開発のためのショートカット
1. **初期段階では**
   - 完璧なエラーハンドリングより機能実装優先
   - 簡易的なパターンマッチングから始める
   - 見つけやすい財務項目（合計、収入、支出等）のみ対象

2. **段階的な精度向上**
   - 基本機能が動作した後に精度向上に注力
   - ケースバイケースで調整可能な設計

この方針に従えば、初期段階で基本機能を迅速にテストし、その後徐々に機能を拡張していくことができます。特にJupyterノートブックを活用することで、インタラクティブに開発と検証を行いながら、システムを段階的に育てていくことが可能です。
